<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StandLog Analytics - MVP Demo</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
      }

      .hero {
        text-align: center;
        padding: 60px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        margin-bottom: 40px;
      }

      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
      }

      .feature {
        padding: 30px;
        background: #f8f9fa;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .feature:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .demo-section {
        margin: 40px 0;
        padding: 30px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .heatmap-container {
        position: relative;
        height: 300px;
        background: #f0f0f0;
        border: 2px dashed #ccc;
        border-radius: 8px;
        margin: 20px 0;
      }

      .btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        margin: 10px;
        font-size: 16px;
        transition: background 0.2s;
      }

      .btn:hover {
        background: #5a6fd8;
      }

      .btn-secondary {
        background: #6c757d;
      }

      .btn-secondary:hover {
        background: #5a6268;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .stat {
        text-align: center;
        padding: 20px;
        background: #e9ecef;
        border-radius: 6px;
      }

      .stat-value {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
      }

      .log {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 15px;
        font-family: monospace;
        font-size: 14px;
        max-height: 200px;
        overflow-y: auto;
      }

      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .dashboard-card {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .dashboard-card h4 {
        margin: 0 0 15px 0;
        color: #495057;
        border-bottom: 2px solid #667eea;
        padding-bottom: 8px;
      }

      .metric-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .metric-row:last-child {
        border-bottom: none;
      }

      .metric-label {
        font-weight: 500;
        color: #6c757d;
      }

      .metric-value {
        font-weight: bold;
        color: #667eea;
        font-size: 1.1em;
      }

      .heatmap-point {
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: radial-gradient(
          circle,
          rgba(255, 0, 0, 0.7) 0%,
          rgba(255, 0, 0, 0.3) 50%,
          rgba(255, 0, 0, 0.1) 100%
        );
        pointer-events: none;
        transform: translate(-50%, -50%);
        animation: heatmapPulse 2s infinite;
      }

      @keyframes heatmapPulse {
        0% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0.7;
        }
        50% {
          transform: translate(-50%, -50%) scale(1.2);
          opacity: 1;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0.7;
        }
      }

      .live-indicator {
        display: inline-block;
        width: 10px;
        height: 10px;
        background: #28a745;
        border-radius: 50%;
        animation: blink 1s infinite;
        margin-right: 8px;
      }

      @keyframes blink {
        0%,
        50% {
          opacity: 1;
        }
        51%,
        100% {
          opacity: 0.3;
        }
      }
    </style>
  </head>
  <body>
    <div class="hero">
      <h1>üöÄ StandLog Analytics MVP</h1>
      <p>
        Interactive heatmaps, funnels, personas, real-time dashboard, and
        integrations
      </p>
      <p><strong>Open DevTools Console to see tracking in action!</strong></p>
    </div>

    <div class="features">
      <div class="feature" onclick="showHeatmaps()">
        <h3>üìç Interactive Heatmaps</h3>
        <p>Click tracking with zoom/pan controls</p>
      </div>

      <div class="feature" onclick="showFunnels()">
        <h3>üîÄ Conversion Funnels</h3>
        <p>Track user flows and drop-offs</p>
      </div>

      <div class="feature" onclick="showPersonas()">
        <h3>üë• User Personas</h3>
        <p>Automatic segmentation</p>
      </div>

      <div class="feature" onclick="showDashboard()">
        <h3>üìä Real-time Dashboard</h3>
        <p>Live activity monitoring</p>
      </div>

      <div class="feature" onclick="showIntegrations()">
        <h3>üì§ Export & Integrations</h3>
        <p>JSON, CSV, Slack, Jira</p>
      </div>

      <div class="feature" onclick="testTracking()">
        <h3>üëª Invisible Tracking</h3>
        <p>Zero-config setup</p>
      </div>
    </div>

    <div class="demo-section">
      <h2>üéØ Try the Features</h2>
      <div class="stats">
        <div class="stat">
          <div class="stat-value" id="clickCount">0</div>
          <div>Clicks Tracked</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="scrollCount">0</div>
          <div>Scroll Events</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="eventCount">0</div>
          <div>Total Events</div>
        </div>
      </div>

      <button class="btn" onclick="trackCustomEvent()">
        Track Custom Event
      </button>
      <button class="btn btn-secondary" onclick="simulateSignup()">
        Simulate Signup Flow
      </button>
      <button class="btn btn-secondary" onclick="exportData()">
        Export Data
      </button>
      <button class="btn btn-secondary" onclick="clearData()">
        Clear Data
      </button>
    </div>

    <div class="demo-section">
      <h3>üìç Heatmap Visualization</h3>
      <div id="heatmap-container" class="heatmap-container">
        <p style="text-align: center; padding-top: 130px; color: #666">
          Click anywhere in this area to generate heatmap data!
        </p>
      </div>
      <button class="btn" onclick="createHeatmap()">Show Click Heatmap</button>
      <button class="btn btn-secondary" onclick="clearHeatmap()">
        Clear Heatmap
      </button>
    </div>

    <div class="demo-section">
      <h3>üìä Live Dashboard</h3>
      <div class="dashboard-grid">
        <div class="dashboard-card">
          <h4><span class="live-indicator"></span>Real-time Metrics</h4>
          <div class="metric-row">
            <span class="metric-label">Active Session</span>
            <span class="metric-value" id="sessionStatus">Active</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Session Duration</span>
            <span class="metric-value" id="sessionDuration">0s</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Page Views</span>
            <span class="metric-value" id="dashboardPageViews">1</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Anonymous ID</span>
            <span class="metric-value" id="anonymousId">Loading...</span>
          </div>
        </div>

        <div class="dashboard-card">
          <h4>üéØ User Interaction</h4>
          <div class="metric-row">
            <span class="metric-label">Total Clicks</span>
            <span class="metric-value" id="dashboardClicks">0</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Scroll Events</span>
            <span class="metric-value" id="dashboardScrolls">0</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Form Submissions</span>
            <span class="metric-value" id="dashboardForms">0</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Custom Events</span>
            <span class="metric-value" id="dashboardCustom">0</span>
          </div>
        </div>

        <div class="dashboard-card">
          <h4>üåê Session Details</h4>
          <div class="metric-row">
            <span class="metric-label">Browser</span>
            <span class="metric-value" id="dashboardBrowser">Chrome</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Device Type</span>
            <span class="metric-value" id="dashboardDevice">Desktop</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Screen Size</span>
            <span class="metric-value" id="dashboardScreen">1920x1080</span>
          </div>
          <div class="metric-row">
            <span class="metric-label">Language</span>
            <span class="metric-value" id="dashboardLanguage">en-US</span>
          </div>
        </div>

        <div class="dashboard-card">
          <h4>üìà Recent Activity</h4>
          <div id="recentActivity" style="font-size: 0.9em; line-height: 1.4">
            <div style="color: #6c757d; font-style: italic">
              No recent events...
            </div>
          </div>
        </div>
      </div>
      <button class="btn" onclick="toggleDashboard()">
        <span id="dashboardToggle">‚ñ∂Ô∏è Start Live Updates</span>
      </button>
      <button class="btn btn-secondary" onclick="refreshDashboard()">
        üîÑ Refresh Now
      </button>
    </div>

    <div class="demo-section">
      <h3>üìã Event Log</h3>
      <div id="event-log" class="log">Analytics events will appear here...</div>
    </div>

    <!-- StandLog Analytics Script -->
    <script
      src="js/script.js"
      data-standlog-id="demo-key-12345"
      data-debug="true"
    ></script>

    <script>
      let eventCount = 0;
      let currentHeatmap = null;
      let dashboardInterval = null;
      let isDashboardActive = false;
      let startTime = Date.now();

      // Update stats display
      function updateStats() {
        if (window.standlog) {
          const analytics = standlog.getAnalytics();
          document.getElementById("clickCount").textContent =
            analytics.session.clicks;
          document.getElementById("scrollCount").textContent =
            analytics.session.scrolls;
          document.getElementById("eventCount").textContent =
            analytics.events.length;

          // Update event log
          const eventLog = document.getElementById("event-log");
          const recentEvents = analytics.events.slice(-10).reverse();
          eventLog.innerHTML =
            recentEvents
              .map(
                (event) =>
                  `[${new Date(event.timestamp).toLocaleTimeString()}] ${
                    event.type
                  } - ${event.url || "N/A"}`
              )
              .join("\n") || "No events yet...";
        }
      }

      // Update dashboard
      function updateDashboard() {
        if (window.standlog) {
          const analytics = standlog.getAnalytics();
          const sessionData = standlog.sessionData;

          // Session metrics
          document.getElementById("sessionDuration").textContent =
            Math.floor((Date.now() - startTime) / 1000) + "s";
          document.getElementById("anonymousId").textContent =
            sessionData.anonymousId || "Loading...";

          // Interaction metrics
          document.getElementById("dashboardClicks").textContent =
            analytics.session.clicks;
          document.getElementById("dashboardScrolls").textContent =
            analytics.session.scrolls;

          // Count different event types
          const events = analytics.events;
          const formEvents = events.filter(
            (e) => e.type === "form_submit"
          ).length;
          const customEvents = events.filter((e) => e.type === "custom").length;

          document.getElementById("dashboardForms").textContent = formEvents;
          document.getElementById("dashboardCustom").textContent = customEvents;

          // Device info
          const deviceInfo = standlog.getDeviceInfo();
          document.getElementById("dashboardBrowser").textContent =
            standlog.getBrowser(navigator.userAgent);
          document.getElementById("dashboardDevice").textContent =
            deviceInfo.type.charAt(0).toUpperCase() + deviceInfo.type.slice(1);
          document.getElementById(
            "dashboardScreen"
          ).textContent = `${screen.width}x${screen.height}`;
          document.getElementById("dashboardLanguage").textContent =
            navigator.language;

          // Recent activity
          const recentActivity = document.getElementById("recentActivity");
          const recentEvents = events.slice(-5).reverse();

          if (recentEvents.length > 0) {
            recentActivity.innerHTML = recentEvents
              .map(
                (event) =>
                  `<div style="margin-bottom: 5px; padding: 5px; background: #f8f9fa; border-radius: 3px; border-left: 3px solid #667eea;">
                <strong>${event.type}</strong> - ${new Date(
                    event.timestamp
                  ).toLocaleTimeString()}
              </div>`
              )
              .join("");
          } else {
            recentActivity.innerHTML =
              '<div style="color: #6c757d; font-style: italic;">No recent events...</div>';
          }
        }
      }

      // Update stats every second
      setInterval(updateStats, 1000);

      // Demo functions
      function showHeatmaps() {
        alert(
          "üìç Interactive Heatmaps:\n‚Ä¢ Zoom/pan controls\n‚Ä¢ Click coordinate tracking\n‚Ä¢ Scroll depth analysis\n\nTry clicking in the heatmap area below!"
        );
      }

      function showFunnels() {
        if (window.standlog) {
          // Define a demo funnel
          standlog.defineFunnel(
            "demo",
            [
              { id: "landing", name: "Landing Page", url: "/" },
              {
                id: "features",
                name: "View Features",
                event: "feature_viewed",
              },
              { id: "signup", name: "Signup", event: "signup_completed" },
            ],
            { name: "Demo Funnel" }
          );

          alert(
            "üîÄ Conversion Funnel Created!\nDemo funnel with 3 steps defined. Check console for details."
          );
          console.log(
            "Funnel defined:",
            standlog.modules.funnels.funnels.get("demo")
          );
        }
      }

      function showPersonas() {
        if (window.standlog) {
          const personas = standlog.modules.personas.analyzeUser(
            standlog.sessionData.userId
          );
          alert(
            `üë• User Personas:\nYou are currently categorized as: ${
              personas.join(", ") || "None yet"
            }\n\nPersonas update based on your behavior!`
          );
        }
      }

      function showDashboard() {
        showLiveDashboard();
      }

      function showIntegrations() {
        if (window.standlog) {
          const data = standlog.exportData("json");
          alert(
            "üì§ Export & Integrations:\n‚Ä¢ JSON, CSV, PDF export\n‚Ä¢ Slack/Jira integration\n‚Ä¢ Webhook support\n\nCheck console for exported data!"
          );
          console.log("Exported data:", JSON.parse(data));
        }
      }

      function testTracking() {
        alert(
          "üëª Invisible Tracking:\n‚Ä¢ Zero user-facing UI\n‚Ä¢ Lightweight tracking\n‚Ä¢ Privacy-focused\n\nAll interactions are being tracked invisibly!"
        );
      }

      function trackCustomEvent() {
        if (window.standlog) {
          standlog.track("custom_demo_event", {
            button: "demo",
            timestamp: Date.now(),
            userAgent: navigator.userAgent,
          });
          alert("‚úÖ Custom event tracked! Check the event log below.");
        }
      }

      function simulateSignup() {
        if (window.standlog) {
          // Track funnel steps
          standlog.track("feature_viewed", { feature: "demo" });
          setTimeout(() => {
            standlog.track("signup_completed", { method: "demo" });
            alert("üéØ Signup flow simulated! Funnel steps tracked.");
          }, 1000);
        }
      }

      function exportData() {
        if (window.standlog) {
          const jsonData = standlog.exportData("json");
          const csvData = standlog.exportData("csv");

          console.log("JSON Export:", jsonData);
          console.log("CSV Export:", csvData);

          // Create download links
          const jsonBlob = new Blob([jsonData], { type: "application/json" });
          const csvBlob = new Blob([csvData], { type: "text/csv" });

          const jsonUrl = URL.createObjectURL(jsonBlob);
          const csvUrl = URL.createObjectURL(csvBlob);

          const jsonLink = document.createElement("a");
          jsonLink.href = jsonUrl;
          jsonLink.download = "standlog-analytics.json";
          jsonLink.click();

          alert(
            "üìä Data exported! JSON file downloaded. Check console for CSV data."
          );
        }
      }

      function clearData() {
        if (window.standlog) {
          standlog.events = [];
          standlog.sessionData.clicks = 0;
          standlog.sessionData.scrolls = 0;
          alert("üóëÔ∏è Analytics data cleared!");
        }
      }

      function createHeatmap() {
        const container = document.getElementById("heatmap-container");

        // Clear existing heatmap
        clearHeatmap();

        if (window.standlog) {
          const analytics = standlog.getAnalytics();
          const clickEvents = analytics.events.filter(
            (e) => e.type === "click" && e.coordinates
          );

          if (clickEvents.length === 0) {
            alert("‚ùå No click data yet. Click around first!");
            return;
          }

          // Create simple heatmap visualization
          clickEvents.forEach((event, index) => {
            if (event.coordinates) {
              const point = document.createElement("div");
              point.className = "heatmap-point";

              // Get container bounds for relative positioning
              const rect = container.getBoundingClientRect();
              const containerRect = {
                left: rect.left + window.scrollX,
                top: rect.top + window.scrollY,
                width: rect.width,
                height: rect.height,
              };

              // Convert page coordinates to container-relative coordinates
              let x = event.coordinates.pageX - containerRect.left;
              let y = event.coordinates.pageY - containerRect.top;

              // Keep points within container bounds
              x = Math.max(10, Math.min(containerRect.width - 10, x));
              y = Math.max(10, Math.min(containerRect.height - 10, y));

              point.style.left = x + "px";
              point.style.top = y + "px";
              point.style.animationDelay = index * 0.2 + "s";

              container.appendChild(point);
            }
          });

          alert(
            `üé® Click heatmap created with ${clickEvents.length} data points! Red dots show click locations.`
          );
        }
      }

      function clearHeatmap() {
        const container = document.getElementById("heatmap-container");
        const points = container.querySelectorAll(".heatmap-point");
        points.forEach((point) => point.remove());

        if (points.length > 0) {
          alert("üßπ Heatmap cleared!");
        }
      }

      function toggleDashboard() {
        const toggleBtn = document.getElementById("dashboardToggle");

        if (isDashboardActive) {
          // Stop dashboard updates
          if (dashboardInterval) {
            clearInterval(dashboardInterval);
            dashboardInterval = null;
          }
          isDashboardActive = false;
          toggleBtn.textContent = "‚ñ∂Ô∏è Start Live Updates";
        } else {
          // Start dashboard updates
          isDashboardActive = true;
          updateDashboard(); // Update immediately
          dashboardInterval = setInterval(updateDashboard, 2000); // Update every 2 seconds
          toggleBtn.textContent = "‚è∏Ô∏è Stop Live Updates";
          alert("üìä Live dashboard activated! Updates every 2 seconds.");
        }
      }

      function refreshDashboard() {
        updateDashboard();
        alert("üîÑ Dashboard refreshed!");
      }

      function showLiveDashboard() {
        if (!isDashboardActive) {
          toggleDashboard();
        } else {
          alert("üìä Dashboard is already active!");
        }
      }

      // Add some demo interactions
      document.addEventListener("DOMContentLoaded", () => {
        console.log("üöÄ StandLog Analytics MVP Demo Ready!");
        console.log("‚Ä¢ All clicks and scrolls are being tracked");
        console.log("‚Ä¢ Use the buttons to explore features");
        console.log("‚Ä¢ Check the event log below for real-time updates");

        // Auto-update stats and dashboard immediately
        setTimeout(() => {
          updateStats();
          updateDashboard();
        }, 1000);

        // Auto-start live dashboard after 2 seconds
        setTimeout(() => {
          if (!isDashboardActive) {
            toggleDashboard();
          }
        }, 2000);
      });
    </script>
  </body>
</html>
